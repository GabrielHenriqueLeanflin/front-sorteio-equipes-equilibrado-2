<header class="d-flex justify-content-between">
  <h2>
    Sorteio Equipes Equilibrado
  </h2>

  <div class="d-flex align-items-center userSair">
    <p>
      Olá, <strong>{{ name }}</strong>!
    </p>

    <hr>

    <a (click)="sair()"> Sair </a>
  </div>
</header>

<div class="tabelas-dashboard">
  <!-- JOGADORES -->
  <div *ngIf="!showCardSorteio" class="d-flex flex-column w-50">
    <div class=" rounded-xl h-14 group-label">
      <p class="label">
        Jogadores
      </p>
    </div>

    <div class="table-jogadores mt-4">

      <p *ngIf="userCache?.jogadores?.length === 0" class="text-aviso">Não existem jogadores cadastrados.</p>

      <div style="display: block; height: 90%; overflow: auto;">
        <table *ngIf="userCache?.jogadores?.length > 0" class="">
          <thead class="">

          <tr class="">
            <th class="">Status</th>
            <th class="">Nome</th>
            <th class="">Posição</th>
            <th class="">Qualidade</th>
            <th class="">Ações</th>
          </tr>

          </thead>

          <tbody class="h-auto">

          <tr *ngFor="let jogador of userCache?.jogadores; let i = index;" class="flex h-9 p-2 gap-1 mt-2 ">
            <td class="text-center">
              <img style="cursor: pointer;" [attr.src]="jogador.status === 1 ? '/assets/images/active.png' : '/assets/images/inactive.png'" alt="Status" (click)="saveStatus(jogador.id, jogador.status)">
            </td>
            <td class="">{{ jogador.name }}</td>
            <td class="text-center">{{ jogador.position }}</td>
            <td class="text-center">{{ jogador.level }}</td>
            <td class="d-flex gap-2 justify-content-center">
              <img style="cursor: pointer;" src="/assets/images/Edit.png" (click)="editJogador()">
              <img style="cursor: pointer;" src="/assets/images/Delete.png" (click)="removerJogador(jogador.id)">
            </td>
          </tr>

          </tbody>
        </table>
      </div>

      <div class="d-flex justify-content-around">
        <p class="text-legenda"><img style="cursor: pointer;" src="/assets/images/active.png">Ativos: {{ arrayJogadoresAtivos?.length }} Jogadores</p>
        <p class="text-legenda"><img style="cursor: pointer;" src="/assets/images/yellow.png">Cadastrado: {{ userCache?.jogadores?.length }} Jogadores</p>
      </div>
    </div>
  </div>

  <!-- SORTEAR -->
  <div *ngIf="!showAdicionarJogador" class="d-flex flex-column w-50">
    <div class="group-label">
      <p class="label">
        Sortear
      </p>
    </div>

    <div class="table-jogadores mt-4">
      <div [formGroup]="formSorteio" class="w-100 d-flex flex-column align-items-center mt-5">
        <div class="w-75 d-flex flex-column mb-3">
            <label class="mb-2">Quantidade de Equipes:</label>
            <input type="number" formControlName="numero_opcoes"/>
            <mat-error *ngIf="formSorteioInvalid">Campo obrigatório</mat-error>
        </div>

        <div class="w-75 d-flex flex-column mb-3">
          <label class="mb-2">Quantidade de Equipes:</label>
          <input type="number" formControlName="numero_equipes"/>
          <mat-error *ngIf="formSorteioInvalid">Campo obrigatório</mat-error>
        </div>
      </div>

      <div class="d-flex">
        <button class="btn btn-primary w-25 mx-auto" (click)="sortear()">
          Gerar Equipes
        </button>

        <button class="btn btnSortear btn-primary w-25 mx-auto" (click)="addJogador()">
          Adicionar Jogador
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="showAdicionarJogador" class="d-flex flex-column w-50">
    <div class="group-label">
      <p class="label">
        Adicionar Jogador
      </p>
    </div>

    <div class="table-jogadores mt-4">
      <div [formGroup]="formCriarJogador" class="w-100 d-flex flex-column align-items-center">
        <div class="w-75 d-flex flex-column mb-3">
          <label class="mb-2">Nome:</label>
          <input type="text" formControlName="nome"/>
          <mat-error *ngIf="formCriarJogadorInvalid">Campo obrigatório</mat-error>
        </div>

        <div class="w-75 d-flex flex-column mb-3">
          <label class="mb-2">Qualidade:</label>
          <mat-select type="number" formControlName="qualidade">
            <mat-option [value]="5">5</mat-option>
            <mat-option [value]="6">6</mat-option>
            <mat-option [value]="7">7</mat-option>
            <mat-option [value]="8">8</mat-option>
            <mat-option [value]="9">9</mat-option>
            <mat-option [value]="10">10</mat-option>
          </mat-select>
          <mat-error *ngIf="formCriarJogadorInvalid">Campo obrigatório</mat-error>
        </div>

        <div class="w-75 d-flex flex-column mb-3">
          <label type="number" class="mb-2">Posição:</label>
          <mat-select formControlName="posicao">
            <mat-option [value]="'GOL'">GOL</mat-option>
            <mat-option [value]="'ZAG'">ZAG</mat-option>
            <mat-option [value]="'MEI'">MEI</mat-option>
            <mat-option [value]="'ATA'">ATA</mat-option>
          </mat-select>
          <mat-error *ngIf="formCriarJogadorInvalid">Campo obrigatório</mat-error>
        </div>
      </div>

      <div class="d-flex justify-content-center">
        <button class="btn btn-primary w-25 mx-auto" (click)="voltar()">
          Voltar
        </button>

        <button class="btn btnSortear btn-primary w-25 mx-auto" (click)="salvarJogador()">
          Salvar
        </button>
      </div>
    </div>
  </div>
</div>

<app-card-sorteado
  *ngIf="showCardSorteio"
  [equipesSorteadasInput] = "equipesSorteadas"
  (equipesSorteadasOutput) = "emitShowCardSorteio($event)"
></app-card-sorteado>

